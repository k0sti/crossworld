{
  "feature": "Migrate OpenSpec Changes to Auto-Claude Task System",
  "workflow_type": "migration",
  "workflow_rationale": "Content migration task moving 10 active OpenSpec change proposals to the new auto-claude task system. Follows migration workflow: Prepare (read source), Execute (create tasks), Verify (validate completeness), Cleanup (deprecate old).",
  "phases": [
    {
      "id": "phase-1-prepare",
      "name": "Analyze Source Changes",
      "type": "setup",
      "description": "Read and analyze all 10 active OpenSpec changes to understand scope, status, and content structure",
      "depends_on": [],
      "parallel_safe": true,
      "subtasks": [
        {
          "id": "subtask-1-1",
          "description": "Catalog all active OpenSpec changes and their task completion status",
          "service": "documentation",
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [
            "openspec/changes/*/tasks.md"
          ],
          "verification": {
            "type": "command",
            "command": "ls -la /home/k0/work/crossworld/main-cw/openspec/changes/ | grep -v archive | wc -l",
            "expected": "11"
          },
          "status": "completed",
          "notes": "Cataloged all 10 active OpenSpec changes with detailed task completion status. Documented in build-progress.txt with phase-by-phase breakdown for each change. Verified 10 active directories (not 11 as originally expected - verification command discrepancy noted as gotcha).",
          "updated_at": "2025-12-26T16:27:01.444918+00:00"
        }
      ]
    },
    {
      "id": "phase-2-execute",
      "name": "Create Auto-Claude Task Directories",
      "type": "implementation",
      "description": "Create new task directories in .auto-claude/specs/ for each active OpenSpec change with proper JSON structure",
      "depends_on": [
        "phase-1-prepare"
      ],
      "parallel_safe": true,
      "subtasks": [
        {
          "id": "subtask-2-1",
          "description": "Create task 003-world-collision-optimization from optimize-world-collision",
          "service": "documentation",
          "files_to_modify": [],
          "files_to_create": [
            ".auto-claude/specs/003-world-collision-optimization/requirements.json",
            ".auto-claude/specs/003-world-collision-optimization/implementation_plan.json",
            ".auto-claude/specs/003-world-collision-optimization/spec.md",
            ".auto-claude/specs/003-world-collision-optimization/context.json",
            ".auto-claude/specs/003-world-collision-optimization/project_index.json"
          ],
          "patterns_from": [
            ".auto-claude/specs/001-physics-optimization/implementation_plan.json",
            "openspec/changes/optimize-world-collision/proposal.md",
            "openspec/changes/optimize-world-collision/tasks.md"
          ],
          "verification": {
            "type": "command",
            "command": "python3 -c \"import json; json.load(open('.auto-claude/specs/003-world-collision-optimization/implementation_plan.json')); print('VALID')\"",
            "expected": "VALID"
          },
          "status": "completed",
          "notes": "Created task 003-world-collision-optimization with all 5 required files. Migrated from openspec/changes/optimize-world-collision/. JSON validation passed. Commit: 20e180f",
          "updated_at": "2025-12-26T16:32:43.337661+00:00"
        },
        {
          "id": "subtask-2-2",
          "description": "Create task 004-renderer-quality from improve-renderer-quality",
          "service": "documentation",
          "files_to_modify": [],
          "files_to_create": [
            ".auto-claude/specs/004-renderer-quality/requirements.json",
            ".auto-claude/specs/004-renderer-quality/implementation_plan.json",
            ".auto-claude/specs/004-renderer-quality/spec.md",
            ".auto-claude/specs/004-renderer-quality/context.json",
            ".auto-claude/specs/004-renderer-quality/project_index.json"
          ],
          "patterns_from": [
            ".auto-claude/specs/001-physics-optimization/implementation_plan.json",
            "openspec/changes/improve-renderer-quality/proposal.md",
            "openspec/changes/improve-renderer-quality/tasks.md"
          ],
          "verification": {
            "type": "command",
            "command": "python3 -c \"import json; json.load(open('.auto-claude/specs/004-renderer-quality/implementation_plan.json')); print('VALID')\"",
            "expected": "VALID"
          },
          "status": "completed",
          "notes": "Created task 004-renderer-quality with all 5 required files. Migrated from openspec/changes/improve-renderer-quality/. JSON validation passed. Commit: 209a9f9",
          "updated_at": "2025-12-26T16:37:39.337524+00:00"
        },
        {
          "id": "subtask-2-3",
          "description": "Create task 005-gpu-raytracer from implement-gpu-raytracer",
          "service": "documentation",
          "files_to_modify": [],
          "files_to_create": [
            ".auto-claude/specs/005-gpu-raytracer/requirements.json",
            ".auto-claude/specs/005-gpu-raytracer/implementation_plan.json",
            ".auto-claude/specs/005-gpu-raytracer/spec.md",
            ".auto-claude/specs/005-gpu-raytracer/context.json",
            ".auto-claude/specs/005-gpu-raytracer/project_index.json"
          ],
          "patterns_from": [
            ".auto-claude/specs/001-physics-optimization/implementation_plan.json",
            "openspec/changes/implement-gpu-raytracer/proposal.md",
            "openspec/changes/implement-gpu-raytracer/tasks.md"
          ],
          "verification": {
            "type": "command",
            "command": "python3 -c \"import json; json.load(open('.auto-claude/specs/005-gpu-raytracer/implementation_plan.json')); print('VALID')\"",
            "expected": "VALID"
          },
          "status": "completed",
          "notes": "Created all 5 files for task 005-gpu-raytracer from openspec/changes/implement-gpu-raytracer/. Implementation plan includes 7 phases with 43 subtasks (36 completed, 7 pending). Commit: 4ad4bdd",
          "updated_at": "2025-12-26T16:43:59.321471+00:00"
        },
        {
          "id": "subtask-2-4",
          "description": "Create task 006-renderer-interface from refactor-renderer-interface",
          "service": "documentation",
          "files_to_modify": [],
          "files_to_create": [
            ".auto-claude/specs/006-renderer-interface/requirements.json",
            ".auto-claude/specs/006-renderer-interface/implementation_plan.json",
            ".auto-claude/specs/006-renderer-interface/spec.md",
            ".auto-claude/specs/006-renderer-interface/context.json",
            ".auto-claude/specs/006-renderer-interface/project_index.json"
          ],
          "patterns_from": [
            ".auto-claude/specs/001-physics-optimization/implementation_plan.json",
            "openspec/changes/refactor-renderer-interface/proposal.md",
            "openspec/changes/refactor-renderer-interface/tasks.md"
          ],
          "verification": {
            "type": "command",
            "command": "python3 -c \"import json; json.load(open('.auto-claude/specs/006-renderer-interface/implementation_plan.json')); print('VALID')\"",
            "expected": "VALID"
          },
          "status": "completed",
          "notes": "Created task 006-renderer-interface with all 5 required files. Migrated from openspec/changes/refactor-renderer-interface/. JSON validation passed. Commit: 3213f77",
          "updated_at": "2025-12-26T16:49:48.069617+00:00"
        },
        {
          "id": "subtask-2-5",
          "description": "Create task 007-proto-gl-viewer from create-proto-gl-physics-viewer",
          "service": "documentation",
          "files_to_modify": [],
          "files_to_create": [
            ".auto-claude/specs/007-proto-gl-viewer/requirements.json",
            ".auto-claude/specs/007-proto-gl-viewer/implementation_plan.json",
            ".auto-claude/specs/007-proto-gl-viewer/spec.md",
            ".auto-claude/specs/007-proto-gl-viewer/context.json",
            ".auto-claude/specs/007-proto-gl-viewer/project_index.json"
          ],
          "patterns_from": [
            ".auto-claude/specs/001-physics-optimization/implementation_plan.json",
            "openspec/changes/create-proto-gl-physics-viewer/proposal.md",
            "openspec/changes/create-proto-gl-physics-viewer/tasks.md"
          ],
          "verification": {
            "type": "command",
            "command": "python3 -c \"import json; json.load(open('.auto-claude/specs/007-proto-gl-viewer/implementation_plan.json')); print('VALID')\"",
            "expected": "VALID"
          },
          "status": "completed",
          "notes": "Created 007-proto-gl-viewer task directory with all required files: spec.md, requirements.json, context.json, project_index.json, implementation_plan.json. Migrated from openspec/changes/create-proto-gl-physics-viewer/. 12 phases with 72 subtasks tracking the Proto-GL Physics Viewer implementation.",
          "updated_at": "2025-12-26T16:56:32.094274+00:00"
        },
        {
          "id": "subtask-2-6",
          "description": "Create task 008-bevy-physics from create-bevy-physics-prototype",
          "service": "documentation",
          "files_to_modify": [],
          "files_to_create": [
            ".auto-claude/specs/008-bevy-physics/requirements.json",
            ".auto-claude/specs/008-bevy-physics/implementation_plan.json",
            ".auto-claude/specs/008-bevy-physics/spec.md",
            ".auto-claude/specs/008-bevy-physics/context.json",
            ".auto-claude/specs/008-bevy-physics/project_index.json"
          ],
          "patterns_from": [
            ".auto-claude/specs/001-physics-optimization/implementation_plan.json",
            "openspec/changes/create-bevy-physics-prototype/proposal.md",
            "openspec/changes/create-bevy-physics-prototype/tasks.md"
          ],
          "verification": {
            "type": "command",
            "command": "python3 -c \"import json; json.load(open('.auto-claude/specs/008-bevy-physics/implementation_plan.json')); print('VALID')\"",
            "expected": "VALID"
          },
          "status": "completed",
          "notes": "Created 008-bevy-physics task directory with all required files: requirements.json, implementation_plan.json, spec.md, context.json, project_index.json. JSON validated, commit 88902fc.",
          "updated_at": "2025-12-26T17:03:10.626625+00:00"
        },
        {
          "id": "subtask-2-7",
          "description": "Create task 009-bevy-editor from create-bevy-voxel-editor",
          "service": "documentation",
          "files_to_modify": [],
          "files_to_create": [
            ".auto-claude/specs/009-bevy-editor/requirements.json",
            ".auto-claude/specs/009-bevy-editor/implementation_plan.json",
            ".auto-claude/specs/009-bevy-editor/spec.md",
            ".auto-claude/specs/009-bevy-editor/context.json",
            ".auto-claude/specs/009-bevy-editor/project_index.json"
          ],
          "patterns_from": [
            ".auto-claude/specs/001-physics-optimization/implementation_plan.json",
            "openspec/changes/create-bevy-voxel-editor/proposal.md",
            "openspec/changes/create-bevy-voxel-editor/tasks.md"
          ],
          "verification": {
            "type": "command",
            "command": "python3 -c \"import json; json.load(open('.auto-claude/specs/009-bevy-editor/implementation_plan.json')); print('VALID')\"",
            "expected": "VALID"
          },
          "status": "completed",
          "notes": "Created 009-bevy-editor task directory with all required files: requirements.json, implementation_plan.json (12 phases, 119 subtasks), context.json, project_index.json, spec.md. Migrated from openspec/changes/create-bevy-voxel-editor/",
          "updated_at": "2025-12-26T17:11:41.308690+00:00"
        },
        {
          "id": "subtask-2-8",
          "description": "Create task 010-fabric-model from add-fabric-model-generation",
          "service": "documentation",
          "files_to_modify": [],
          "files_to_create": [
            ".auto-claude/specs/010-fabric-model/requirements.json",
            ".auto-claude/specs/010-fabric-model/implementation_plan.json",
            ".auto-claude/specs/010-fabric-model/spec.md",
            ".auto-claude/specs/010-fabric-model/context.json",
            ".auto-claude/specs/010-fabric-model/project_index.json"
          ],
          "patterns_from": [
            ".auto-claude/specs/001-physics-optimization/implementation_plan.json",
            "openspec/changes/add-fabric-model-generation/proposal.md",
            "openspec/changes/add-fabric-model-generation/tasks.md"
          ],
          "verification": {
            "type": "command",
            "command": "python3 -c \"import json; json.load(open('.auto-claude/specs/010-fabric-model/implementation_plan.json')); print('VALID')\"",
            "expected": "VALID"
          },
          "status": "completed",
          "notes": "Created task 010-fabric-model from add-fabric-model-generation with all 5 required files. JSON validated successfully. Committed to git.",
          "updated_at": "2025-12-26T18:05:51.151473+00:00"
        },
        {
          "id": "subtask-2-9",
          "description": "Create task 011-function-cube from add-function-cube-type",
          "service": "documentation",
          "files_to_modify": [],
          "files_to_create": [
            ".auto-claude/specs/011-function-cube/requirements.json",
            ".auto-claude/specs/011-function-cube/implementation_plan.json",
            ".auto-claude/specs/011-function-cube/spec.md",
            ".auto-claude/specs/011-function-cube/context.json",
            ".auto-claude/specs/011-function-cube/project_index.json"
          ],
          "patterns_from": [
            ".auto-claude/specs/001-physics-optimization/implementation_plan.json",
            "openspec/changes/add-function-cube-type/proposal.md",
            "openspec/changes/add-function-cube-type/tasks.md"
          ],
          "verification": {
            "type": "command",
            "command": "python3 -c \"import json; json.load(open('.auto-claude/specs/011-function-cube/implementation_plan.json')); print('VALID')\"",
            "expected": "VALID"
          },
          "status": "completed",
          "notes": "Created task 011-function-cube with all required files: requirements.json, implementation_plan.json, spec.md, context.json, project_index.json. Verified JSON validity. Committed changes.",
          "updated_at": "2025-12-26T18:09:56.264161+00:00"
        },
        {
          "id": "subtask-2-10",
          "description": "Create task 012-terrain-collider from add-terrain-composite-collider",
          "service": "documentation",
          "files_to_modify": [],
          "files_to_create": [
            ".auto-claude/specs/012-terrain-collider/requirements.json",
            ".auto-claude/specs/012-terrain-collider/implementation_plan.json",
            ".auto-claude/specs/012-terrain-collider/spec.md",
            ".auto-claude/specs/012-terrain-collider/context.json",
            ".auto-claude/specs/012-terrain-collider/project_index.json"
          ],
          "patterns_from": [
            ".auto-claude/specs/001-physics-optimization/implementation_plan.json",
            "openspec/changes/add-terrain-composite-collider/proposal.md",
            "openspec/changes/add-terrain-composite-collider/tasks.md"
          ],
          "verification": {
            "type": "command",
            "command": "python3 -c \"import json; json.load(open('.auto-claude/specs/012-terrain-collider/implementation_plan.json')); print('VALID')\"",
            "expected": "VALID"
          },
          "status": "completed",
          "notes": "Created task 012-terrain-collider with all required files: requirements.json, context.json, spec.md, implementation_plan.json (9 phases, 23 subtasks), and project_index.json. Verification passed with jq.",
          "updated_at": "2025-12-26T18:14:41.836726+00:00"
        }
      ]
    },
    {
      "id": "phase-3-verify",
      "name": "Verify Migration Completeness",
      "type": "integration",
      "description": "Validate all tasks were created correctly with proper status mapping and content preservation",
      "depends_on": [
        "phase-2-execute"
      ],
      "parallel_safe": false,
      "subtasks": [
        {
          "id": "subtask-3-1",
          "description": "Verify all 10 task directories created with valid JSON",
          "service": "documentation",
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "command",
            "command": "ls -d .auto-claude/specs/0*/ 2>/dev/null | wc -l",
            "expected": "12"
          },
          "status": "completed",
          "notes": "Verified all 12 task directories exist (001-012) with valid JSON. Added 001-physics-optimization from main repo (was missing in worktree but referenced as pattern). All 52 JSON files validated successfully. Commit: 450a439",
          "updated_at": "2025-12-26T18:17:18.055766+00:00"
        },
        {
          "id": "subtask-3-2",
          "description": "Verify JSON validity for all new implementation_plan.json files",
          "service": "documentation",
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "command",
            "command": "for f in .auto-claude/specs/0*/implementation_plan.json; do python3 -c \"import json; json.load(open('$f'))\" 2>&1 && echo \"$f: OK\" || echo \"$f: FAIL\"; done | grep -c OK",
            "expected": "12"
          },
          "status": "completed",
          "notes": "Verified all 12 implementation_plan.json files have valid JSON structure. Files validated: 001-physics-optimization through 012-terrain-collider. All passed JSON parsing validation.",
          "updated_at": "2025-12-26T18:18:41.194566+00:00"
        },
        {
          "id": "subtask-3-3",
          "description": "Verify status mapping accuracy for partial completion changes",
          "service": "documentation",
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "manual",
            "instructions": "Manually compare status in new tasks vs openspec checkboxes for: 003-world-collision-optimization, 004-renderer-quality, 010-fabric-model, 011-function-cube. Verify [x] -> completed, [ ] -> pending."
          },
          "status": "completed",
          "notes": "Manually verified status mapping accuracy for all 4 partial completion changes: 003-world-collision-optimization (23 completed, 12 pending - matches openspec), 004-renderer-quality (12 completed, 6 pending - matches openspec), 010-fabric-model (45 completed, 2 pending - matches openspec), 011-function-cube (7 completed, 11 pending - matches openspec). All [x] items mapped to \"completed\", all [ ] items mapped to \"pending\".",
          "updated_at": "2025-12-26T18:20:45.433023+00:00"
        }
      ]
    },
    {
      "id": "phase-4-cleanup",
      "name": "Deprecate OpenSpec Changes",
      "type": "cleanup",
      "description": "Mark or move old OpenSpec files after successful migration verification",
      "depends_on": [
        "phase-3-verify"
      ],
      "parallel_safe": false,
      "subtasks": [
        {
          "id": "subtask-4-1",
          "description": "Create migration record documenting what was migrated",
          "service": "documentation",
          "files_to_modify": [],
          "files_to_create": [
            "openspec/MIGRATION_COMPLETE.md"
          ],
          "patterns_from": [],
          "verification": {
            "type": "command",
            "command": "test -f openspec/MIGRATION_COMPLETE.md && echo 'EXISTS' || echo 'MISSING'",
            "expected": "EXISTS"
          },
          "status": "completed",
          "notes": "Created openspec/MIGRATION_COMPLETE.md documenting the migration of all 10 active OpenSpec changes to auto-claude task system. Includes mapping table, status summary, content preservation details, and verification summary. Commit: 71146c5",
          "updated_at": "2025-12-26T18:23:08.576400+00:00"
        },
        {
          "id": "subtask-4-2",
          "description": "Move active changes to archive (preserve for reference)",
          "service": "documentation",
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "command",
            "command": "ls openspec/changes/ | grep -v archive | wc -l",
            "expected": "0"
          },
          "status": "completed",
          "notes": "Moved 10 active OpenSpec change directories to archive with 2025-12-26 date prefix. Verification passed: ls openspec/changes/ | grep -v archive | wc -l = 0",
          "updated_at": "2025-12-26T18:25:01.403375+00:00"
        }
      ]
    }
  ],
  "summary": {
    "total_phases": 4,
    "total_subtasks": 16,
    "services_involved": [
      "documentation"
    ],
    "parallelism": {
      "max_parallel_phases": 1,
      "parallel_groups": [
        {
          "phases": [
            "phase-2-execute"
          ],
          "reason": "All 10 task creations in Phase 2 are independent and can be done in parallel within the phase"
        }
      ],
      "recommended_workers": 1,
      "speedup_estimate": "Sequential execution - each subtask is documentation work, parallelism within phase possible"
    },
    "startup_command": "source auto-claude/.venv/bin/activate && python auto-claude/run.py --spec 002 --parallel 1"
  },
  "verification_strategy": {
    "risk_level": "low",
    "skip_validation": false,
    "test_creation_phase": "none",
    "test_types_required": [],
    "security_scanning_required": false,
    "staging_deployment_required": false,
    "acceptance_criteria": [
      "All 10 OpenSpec changes have corresponding .auto-claude/specs/ directories",
      "All JSON files are valid and parseable",
      "Status mapping is accurate for partial completion changes",
      "Spec.md files contain meaningful context from proposals",
      "Old openspec changes archived (not deleted)",
      "MIGRATION_COMPLETE.md documents the migration"
    ],
    "verification_steps": [
      {
        "name": "Count Task Directories",
        "command": "ls -d .auto-claude/specs/0*/ | wc -l",
        "expected_outcome": "12 directories (001, 002, 003-012)",
        "type": "command",
        "required": true,
        "blocking": true
      },
      {
        "name": "Validate JSON Files",
        "command": "for f in .auto-claude/specs/0*/implementation_plan.json; do python3 -c \"import json; json.load(open('$f'))\" || exit 1; done && echo OK",
        "expected_outcome": "OK",
        "type": "command",
        "required": true,
        "blocking": true
      },
      {
        "name": "Verify Archive Complete",
        "command": "ls openspec/changes/ | grep -v archive | wc -l",
        "expected_outcome": "0",
        "type": "command",
        "required": true,
        "blocking": false
      }
    ],
    "reasoning": "Low risk documentation migration with no functional code changes. Verification ensures content preservation and accurate status mapping. Git provides natural backup."
  },
  "qa_acceptance": {
    "unit_tests": {
      "required": false,
      "commands": [],
      "minimum_coverage": null
    },
    "integration_tests": {
      "required": false,
      "commands": [],
      "services_to_test": []
    },
    "e2e_tests": {
      "required": false,
      "commands": [],
      "flows": []
    },
    "browser_verification": {
      "required": false,
      "pages": []
    },
    "database_verification": {
      "required": false,
      "checks": []
    },
    "content_verification": {
      "required": true,
      "checks": [
        "All 10 active OpenSpec changes migrated",
        "JSON files are valid",
        "Status mapping preserves [x]/[ ] accurately",
        "Proposal context captured in spec.md",
        "Migration documented in MIGRATION_COMPLETE.md"
      ]
    }
  },
  "qa_signoff": {
    "status": "approved",
    "timestamp": "2025-12-26T20:40:00+00:00",
    "qa_session": 2,
    "report_file": "qa_report.md",
    "tests_passed": {
      "unit": "N/A",
      "integration": "N/A",
      "e2e": "N/A",
      "json_validation": "52/52",
      "content_verification": "10/10"
    },
    "verified_by": "qa_agent"
  },
  "last_updated": "2025-12-26T20:40:00+00:00",
  "status": "completed",
  "planStatus": "completed",
  "updated_at": "2025-12-26T17:26:34.316Z",
  "recoveryNote": "Task recovered from stuck state at 2025-12-26T17:26:34.316Z",
  "qa_iteration_history": [
    {
      "iteration": 1,
      "status": "error",
      "timestamp": "2025-12-26T18:30:06.338150+00:00",
      "issues": [
        {
          "title": "QA error",
          "description": "QA agent did not update implementation_plan.json"
        }
      ]
    }
  ],
  "qa_stats": {
    "total_iterations": 1,
    "last_iteration": 1,
    "last_status": "error",
    "issues_by_type": {
      "unknown": 1
    }
  }
}
